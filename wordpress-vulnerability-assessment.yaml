id: wordpress-vulnerability-assessment

info:
  name: WordPress Advanced Vulnerability Assessment
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    This template performs an advanced vulnerability assessment of WordPress installations by checking for various well-known files and configurations that may indicate vulnerabilities.
  tags: wordpress,vulnerability,advanced

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-login.php"
      - "{{BaseURL}}/wp-admin/"
      - "{{BaseURL}}/wp-config.php"
      - "{{BaseURL}}/readme.html"
      - "{{BaseURL}}/license.txt"
      - "{{BaseURL}}/wp-content/debug.log"
      - "{{BaseURL}}/.htaccess"
      - "{{BaseURL}}/.git/config"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "<title>Log In &lsaquo; WordPress</title>"
        part: body
      - type: word
        words:
          - "Index of /wp-admin"
        part: body
      - type: word
        words:
          - "wp-config.php"
        part: body
      - type: word
        words:
          - "WordPress"
        part: body
      - type: regex
        regex:
          - "(?i)debug.log"
        part: body
      - type: word
        words:
          - "# BEGIN WordPress"
        part: body
      - type: regex
        regex:
          - "(?i)git/config"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-login.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "log=admin&pwd=admin"

    matchers:
      - type: word
        words:
          - "invalid username"
        part: body
      - type: word
        words:
          - "incorrect password"
        part: body

variables:
  marker: "{{interactsh-url}}"