id: drupal-nodes-access-controls

info:
  name: Drupal Nodes with Misconfigured Access Controls
  author: intigriti,pdteam
  severity: medium
  description: |
    Drupal Nodes can contain sensitive data, and if permissions are not enforced, they can leak private data to unauthorized users.
  reference:
    - https://github.com/intigriti/misconfig-mapper
    - https://bugology.intigriti.io/misconfig-mapper-docs/services/drupal/drupal-nodes-with-misconfigured-access-controls
    - https://twitter.com/adrien_jeanneau/status/1273952564430725123
    - https://www.drupal.org/docs/core-modules-and-themes/core-modules/node-module/about-nodes
    - https://web.archive.org/web/20220203132234/https://0xblackbird.github.io/blog/post1
  metadata:
    max-request: 1
    vendor: drupal
    product: drupal
    shodan-query:
      - http.component:"drupal"
      - cpe:"cpe:2.3:a:drupal:drupal"
  tags: drupal,misconfig,acl

http:
  - method: GET
    path:
      - "{{BaseURL}}/node/1"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "<meta name=\"generator\" content=\"Drupal"
          - "(https://www.drupal.org)"
          - "/sites/default/files/css/"
